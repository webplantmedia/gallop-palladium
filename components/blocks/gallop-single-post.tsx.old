import { parse } from '@wordpress/block-serialization-default-parser';
import { hasInnerBlocks, getAttr, cleanLink } from '../../lib/utils/tools';
import { InnerBlockContent, BlockContentIntro } from './index';

export const GallopSinglePost = ({ block, parent = null }) => {
  // console.log(block);
  const content = parse(getAttr('content', block));

  let html = <BlockContentIntro content={content} />;
  let mediaItemUrl = getAttr('mediaItemUrl', block);
  let mediaItemAltText = getAttr('mediaItemAltText', block);
  let mediaItemTitle = getAttr('mediaItemTitle', block);
  let title = getAttr('title', block);
  let link = cleanLink(getAttr('link', block));

  if (!mediaItemUrl) {
  }

  if (mediaItemUrl) {
    html = (
      <section className="mb-14 children-y-0 flex flex-col">
        <h2 className="mb-5 leading-tight text-3xl text-primary-main small-caps">
          {title}
        </h2>
        <a className="block" href={link}>
          <img
            alt={mediaItemAltText}
            title={mediaItemTitle}
            className="mb-7 rounded-sm"
            src={mediaItemUrl}
          />
        </a>
        {html}
        {hasInnerBlocks(block) && (
          <InnerBlockContent content={block.innerBlocks} />
        )}
      </section>
    );
  }

  return html;
};
